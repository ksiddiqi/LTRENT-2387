<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="CX Team" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Task 8 Umbrella Regional Policies - Cisco Live 2023 LTRENT-2387</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Task 8 Umbrella Regional Policies";
        var mkdocs_page_input_path = "Task8-v1.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Cisco Live 2023 LTRENT-2387
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Topology/">Topology</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../IP-Users/">Connection Details and Credentials</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Task1-Connect/">Task 1 Remote Connection</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Task2-v1/">Task 2 Devices Feature Templates</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Task3-v1/">Task 3 Regional Internet Access for All Sites</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Task4-v1/">Task 4 Direct Internet Access for Site300</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Task5-v1/">Task 5 Umbrella (SIG) for Site300</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Task6-v1/">Task 6 Umbrella Policy for Site300</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Task7-v1/">Task 7 Umbrella SIG policies for Regional Access</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Task 8 Umbrella Regional Policies</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#step-1-umbrella-web-policy">Step 1 - Umbrella Web Policy</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#step-2-create-customs-list-web-policy">Step 2 - Create Customs-list Web Policy</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#step-3-web-policy-tester">Step 3 - Web Policy Tester</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#step-4-verify-policies-on-hosts">Step 4 - Verify Policies on Hosts</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Task9-v1/">Task 9 Monitoring on Umbrella</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Task10-v1/">Task 10 Modify Block Page Notification</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Task11-v1/">Task 11 Data Loss Prevention</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../Challenge-Tasks/">Challenge Task</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Cisco Live 2023 LTRENT-2387</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Task 8 Umbrella Regional Policies</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/ksiddiqi/LTRENT-2387.git/edit/master/docs/Task8-v1.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="task-8-umbrella-regional-policies">Task 8 - Umbrella Regional Policies</h1>
<p>In this task we will create Web Proxy Policies on Umbrella to be enforced on Site-100 and Site-400 (regional sites). These policies will aim to block web traffic to Financial Institutions and other specified websites using custom destination lists.</p>
<h2 id="step-1-umbrella-web-policy">Step 1 - Umbrella Web Policy</h2>
<p><strong>Objective:</strong> Configure an Umbrella Web Policy to block traffic to Financial websites from Site-400 and Site-100.</p>
<p><strong>1. Accessing the Umbrella Dashboard:</strong></p>
<ul>
<li>On the RDP session (jumphost), logon to Umbrella Dashboard by clicking on Google Chrome Browser bookmark named <code>Umbrella SSO</code>.  It will open the Umbrella dashboard and auto-login using single-sign-on.</li>
</ul>
<p><strong>2. Creating the Web Policy:</strong></p>
<ul>
<li>Go to <strong>Policies &gt; Management &gt; Web Policy</strong> and click <strong>Add</strong> on the top right to add a new <em>Ruleset</em> as shown in below screenshot:</li>
</ul>
<p><img alt="" src="../pics/umbrella-p5.png" /></p>
<p><strong>3. Configuring Ruleset Identities:</strong></p>
<ul>
<li>On the new "<em>Ruleset Rules</em>" web page, under <strong>Ruleset Settings</strong> scroll down to <strong>Ruleset identities</strong> and Click <strong>Edit</strong> as shown below:</li>
</ul>
<p><img alt="" src="../pics/t8-s1-ruleset-identity.png" /></p>
<ul>
<li>Next on the <strong>Ruleset Identities</strong> web page, under <code>All Identities</code> scroll down to <strong>Tunnels</strong> and Click on number 4 with right arrow i.e., <strong><code>4 &gt;</code></strong> as shown below:</li>
</ul>
<p><img alt="" src="../pics/t8-s1-ruleset-identities-tunnels.png" /></p>
<ul>
<li>On the next page, select the two Tunnels for <strong>SITE100</strong> and Click <strong>SAVE</strong> button as shown below: </li>
</ul>
<p><img alt="" src="../pics/t8-s1-ruleset-identities-tunnels-site100.png" /></p>
<table>
<thead>
<tr>
<th style="text-align: left;"><strong>Note:</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Select only SITE100 tunnels.  <em>Do not</em> select SITE300 tunnels in this step.</td>
</tr>
</tbody>
</table>
<ul>
<li>Under the <strong>Ruleset Settings</strong>, scroll down to <strong>HTTPS Inspection</strong> section and click <strong>Edit</strong>:</li>
</ul>
<p><img alt="" src="../pics/umbrella-s1-p10.png" /></p>
<p><strong>4. Enabling HTTPS Inspection:</strong></p>
<ul>
<li>Select <strong>Enable HTTPS Inspection</strong>, then click <strong>Save</strong>:</li>
</ul>
<p><img alt="" src="../pics/umbrella-p18.png" /> </p>
<p><strong>5. Adding Web Policy Rule:</strong></p>
<ul>
<li>After adding the identities, Click <strong>ADD RULE</strong> button.  Give the <strong>Rule Name</strong> of <strong><code>Regional - block Financial</code></strong> and verify the <code>Rule Action</code> is <code>Block</code>:</li>
</ul>
<p><img alt="" src="../pics/t8-s1-add-rule.png" /></p>
<ul>
<li>Next click on <strong>Add Identity</strong> for this rule.  Enable <strong>Inherit Ruleset Identities</strong> and click <strong>Apply</strong> as shown in below figure:</li>
</ul>
<p><img alt="" src="../pics/t8-s1-edit-identity.png" /></p>
<ul>
<li>Further on the new rule, click on <strong>Add Destination</strong> and Click on right arrow <strong><code>&gt;</code></strong> next to <strong>Application Settings</strong>:</li>
</ul>
<p><img alt="" src="../pics/t8-s1-umbrella-edit-dest.png" /></p>
<ul>
<li>Then scroll down to Select <strong>Financial Services</strong> and hit <strong>Apply</strong>:</li>
</ul>
<p><img alt="" src="../pics/t8-s1-umbrella-edit-dest-finance.png" /></p>
<ul>
<li>On the Rule click on <strong>Save</strong> icon to save newly added rule as shown in below screenshot:</li>
</ul>
<p><img alt="" src="../pics/t8-s1-umbrella-edit-dest-save.png" /></p>
<p><strong>6. Enabling the Rule:</strong></p>
<ul>
<li>By default newly created rules are disabled.  To enable the Rule 1, click three dots (<strong><code>...</code></strong>) at the right side and then toggle <strong>Enable Rule</strong> as shown in below screenshot. </li>
</ul>
<p><img alt="" src="../pics/t8-s1-umbrella-rule-enable.png" /></p>
<ul>
<li>Confirm by clicking <strong>Update</strong>:</li>
</ul>
<p><img alt="" src="../pics/umbrella-p14.png" /></p>
<p>Now the rule and ruleset settings are all configured for Regional sites.</p>
<ul>
<li>Scroll down and click <strong>Close</strong> as shown in below screenshot
<img alt="" src="../pics/umbrella-p19.png" /></li>
</ul>
<h2 id="step-2-create-customs-list-web-policy">Step 2 - Create Customs-list Web Policy</h2>
<p><strong>Objective:</strong> Create a custom destination list and a web policy to block specific URLs (as per this custom destination list).</p>
<p><strong>1. Creating Destination List:</strong></p>
<ul>
<li>On Umbrella dashboard, navigate to <strong>Policy &gt; Policy Component &gt; Destination lists</strong>, click <strong>Add</strong> on the top right corner:</li>
</ul>
<p><img alt="" src="../pics/umbrella-s1-p11.png" /></p>
<ul>
<li>
<p>Add this list as per below settings:</p>
<ul>
<li>List Name: <code>Custom-Filter</code></li>
<li>Destination List type: <code>Web Proxy</code> (from drop-down menu)</li>
<li>Destination: <code>www.cnn.com</code></li>
<li>
<p>Click <strong><code>Add</code></strong>
<img alt="" src="../pics/umbrella-s1-p12.png" /></p>
</li>
<li>
<p>Click <strong>Save</strong> after adding destination/domain:
<img alt="" src="../pics/umbrella-s1-p13.png" /></p>
</li>
</ul>
</li>
</ul>
<p><strong>2. Adding Rule to Ruleset:</strong></p>
<ul>
<li>
<p>Navigate to <strong>Policies &gt; Management &gt; Web Policy</strong> and expand on <strong>RuleSet 2</strong> by clicking on it or by clicking down-arrow:</p>
<p><img alt="" src="../pics/umbrella-s1-p14.png" /></p>
</li>
<li>
<p>Let's add a new rule by clicking <strong>ADD RULE</strong> button.  Give the <strong>Rule Name</strong> of <strong><code>Regional - block custom</code></strong> and verify the <code>Rule Action</code> is <code>Block</code>:
<img alt="" src="../pics/add-rule-2.png" /></p>
</li>
<li>
<p>Next let's also use ruleset identities for this rule.  Click on <strong>Add Identity</strong> for this rule and enable <strong>Inherit Ruleset Identities</strong> and click <strong>Apply</strong> as shown in below figure:</p>
</li>
</ul>
<p><img alt="" src="../pics/add-rule-2-identity.png" /></p>
<ul>
<li>Further on the new rule, click on <strong>Add Destination</strong> and CLick on the right arrow  <strong><code>&gt;</code></strong> next to <strong>Destiniation Lists</strong></li>
</ul>
<p><img alt="" src="../pics/add-rule-2-dest.png" /></p>
<ul>
<li>Select the <strong>Custom-Filter</strong> and then click on <strong>Apply</strong></li>
</ul>
<p><img alt="" src="../pics/umbrella-s1-p17.png" /></p>
<ul>
<li>Click on <strong>Save</strong> on this newly created rule:
<img alt="" src="../pics/add-rule-2-save.png" /></li>
</ul>
<p><strong>3. Enabling the Custom Rule:</strong></p>
<ul>
<li>By default newly created rules are disabled.  To enable the Rule 2, click three dots (<strong><code>...</code></strong>) at the right side and then toggle <strong>Enable Rule</strong> as shown in below screenshot. </li>
</ul>
<p><img alt="" src="../pics/rule-2-enable.png" /></p>
<ul>
<li>Confirm by clicking <strong>Update</strong>:</li>
</ul>
<p><img alt="" src="../pics/umbrella-p14.png" /></p>
<ul>
<li>After saving the rule, You may scroll down under Ruleset settings and click on <strong>Close</strong> button.</li>
</ul>
<p>Now the Umbrella policies for regional sites (site-100 and Site-400) have been configured. </p>
<h2 id="step-3-web-policy-tester">Step 3 - Web Policy Tester</h2>
<p><strong>Objective:</strong> Test the newly created Web policies using Umbrella's "Policy Tester".</p>
<p><strong>1. Running Policy Tests:</strong></p>
<ul>
<li>
<p>On Umbrella Dashboard, navigate to <strong>Policies &gt; Management &gt; Web Policy</strong>.  Click on <strong>Policy Tester</strong> at the top right corner: 
<img alt="" src="../pics/umbrella-web-policy-test.png" /></p>
</li>
<li>
<p>On the <code>Web Policy Tester</code> page,</p>
<ul>
<li>Under the <strong>Primary Identity</strong> search box type <strong><code>Site1</code></strong> and then select any of the <strong>Site100</strong> tunnels </li>
<li>Under <strong>Destination</strong>, enter <strong><code>chase.com</code></strong></li>
<li>Then click <strong>Run Test</strong> button: 
<img alt="" src="../pics/web-policy-test-result-regional-1.png" /></li>
</ul>
</li>
</ul>
<p>The result of this test appears on the page and as expected it shows the Ruleset 2 and rule being matched by the Web policy. </p>
<ul>
<li>Next run a test for any of the Site100 tunnel for below destination:<ul>
<li>Under <strong>Destination</strong>, enter <strong><code>www.cnn.com</code></strong>
<img alt="" src="../pics/web-policy-test-result-regional-2.png" /></li>
</ul>
</li>
</ul>
<p>The result of this test appears on the page and as expected it shows the Ruleset 2 and rule being matched by the Web policy. </p>
<ul>
<li>Explore the Web Policy Tester further by testing traffic to different destination website such as cisco.com, google.com for Regional sites traffic.</li>
</ul>
<h2 id="step-4-verify-policies-on-hosts">Step 4 - Verify Policies on Hosts</h2>
<p><strong>Objective:</strong> Confirm the effectiveness of the Web Policies on regional site-400 host.</p>
<p><strong>1. Confirming Traffic Redirection:</strong></p>
<ul>
<li>First validate if traffic is being redirected to Umbrella.<ul>
<li>Using <strong>mRemoteNG</strong>, relaunch the console session of the Ubuntu VM <code>Site400-Ubuntu-VPN10</code>.  Login with credentials of <code>viptela</code></li>
<li>Use Chromium Browser to navigate to <code>welcome.umbrella.com</code>.  A green check mark should appear, confirming that traffic from VPN-10 is being successfully redirected to Umbrella.</li>
</ul>
</li>
</ul>
<p><strong>2. Validating Web Policy:</strong></p>
<ul>
<li>Verify Web Policy by using Chromium Web Browser on the console of <code>Site400-Ubuntu-VPN10</code> host by using <strong>mRemoteNG</strong> application.<ul>
<li>Use Chromium to navigate onto <code>www.cisco.com</code>.  Access to this website should work.</li>
<li>Use Chromium to navigate to <code>www.cnn.com</code>.  As per our Umbrella Web Policy, this site should be blocked and, as expected, Cisco Umbrella block page will appear.</li>
<li>Use Chromium to navigate to <code>www.chase.com</code>.  As per our Umbrella Web Policy, this sites should be blocked and, as expected, Cisco Umbrella block page will appear.</li>
<li>Use Chromium to navigate to <code>www.bankofamerica.com</code>.  As per our Umbrella Web Policy, this sites should be blocked and, as expected, Cisco Umbrella block page will appear.</li>
<li>Use Chromium to navigate onto <code>www.facebook.com</code>.  Access to this site should work as expected</li>
</ul>
</li>
</ul>
<p><strong>Conclusion:</strong></p>
<p>Upon completing Task 8, robust Web Proxy Policies have been successfully established and enforced on regional sites, Site-100 and Site-400. These policies effectively block web traffic to financial institutions and other specific websites as designated in the custom destination lists. </p>
<p>Key accomplishments in this task include:</p>
<ul>
<li>The configuration of Umbrella Web Policies to restrict access to financial websites, enhancing the security and compliance posture of the regional sites.</li>
<li>The creation of custom destination lists, demonstrating the flexibility of Umbrella to tailor web access policies to the organization's specific needs.</li>
<li>Successful testing and validation of these policies using Umbrella's Web Policy Tester, ensuring that the desired web traffic restrictions are in place and functioning as expected.</li>
<li>Verification of policy enforcement on regional site hosts, confirming that traffic is appropriately redirected and filtered according to the newly implemented policies.</li>
</ul>
<p>As a result, Site-100 and Site-400 are now equipped with targeted web access controls, contributing significantly to the overall security framework of the organization's network.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../Task7-v1/" class="btn btn-neutral float-left" title="Task 7 Umbrella SIG policies for Regional Access"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../Task9-v1/" class="btn btn-neutral float-right" title="Task 9 Monitoring on Umbrella">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ksiddiqi/LTRENT-2387.git" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../Task7-v1/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../Task9-v1/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
